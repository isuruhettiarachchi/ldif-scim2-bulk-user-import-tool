# Developer Guide

## Distribution structure

The tool is distributed as a zip file with the following structure.

```bash
.
├── bin
│   └── start.sh
├── org.wso2.ldif.scim-<version>.jar
├── config
│       ├── attribute-schema.json
│       ├── configurations.toml
│       └── internal-attribute-mappings.json
├── INSTRUCTIONS.md
└── lib
└── output
```

- `bin`: Contains the shell script to start the tool.
- `org.wso2.ldif.scim-<version>.jar`: The executable jar file.
- `config`: Contains the configuration files.
    - `attribute-schema.json`: Contains the complete attribute schema JSON which will be used to construct the SCIM request.
    - `configurations.toml`: Contains the configurations for the tool. This file is expected to be updated by the user.
    - `internal-attribute-mappings.json`: Contains the mapping between the internal attribute names and the path in the JSON schema.
- `lib`: Contains the dependency jars required by the tool.
- `output`: Contains the output files generated by the tool.
- `INSTRUCTIONS.md`: Contains the instructions to run the tool. This file will be distributed with the tool.

## System attributes

The tool treats following attributes as special attributes (system attributes) and handle differently in the code level.

- primaryEmail
- password

## Add support for new attributes

The tool by default supports most of the available attributes in WSO2 IS. This includes all the attributes under 
`urn:ietf:params:scim:schemas:core:2.0:User` and `urn:ietf:params:scim:schemas:extension:enterprise:2.0:User`.

If you need to add support for more attributes, follow the steps below.

1. First think of a unique identifier for the attribute. This identifier will be used to map the attribute in the configuration files.

2. Add the attribute to the `attribute-schema.json` file with an empty string as the value. It should be added as per the SCIM payload format. If the attribute has to be sent as a first class attribute, add it to the `core` object. Else add it under the relevant SCIM schema URI.

3. Add the attribute mapping to the `internal-attribute-mappings.json` file. If the attribute has to be sent as a first class attribute, add it to the `core` object. Else add it under the relevant SCIM schema URI.

> [!NOTE]
> JSON schema path should be constructed as per the SCIM payload format.
>   - If the attribute should be sent as a first class attribute, the path will be equal to the attribute name.
>   - If it is a sub attribute of some other element and is not an attribute of a list element, the path should be constructed as `<parentAttributeName>.<subAttributeName>`.
>   - If it is a sub attribute of some other element and is an attribute of a list element, the path should be constructed as `<listAttributeName>#<type>.<subAttributeName>`. Type contains the type of the list object.
